---
title: "Chapter 19 Problem 38"
author: "Jonathan Nelson"
date: "July 22, 2015"
output: html_document
runtime: shiny
---

### Part A, Scatter Plot, Sales v. Volume (gallons)

```{r, include = FALSE}
require(shiny)
require(ggplot2)
require(reshape2)
require(magrittr)

 gas <- read.table("C:\\Users\\Jonathan\\Documents\\GitHub\\AnalyicsData\\Stine&Foster\\Data by Chapter\\Chapter 19\\19_convenience\\19_convenience.txt",
             header = TRUE,
             sep = "\t"
             )
 
names(gas) <- c("sales", "gallons", "washes", "day", "cents", "weekend")

gas$weekend <- factor(gas$weekend, labels = c("WeekDay", "WeekEnd"))
```


```{r, echo = FALSE}
ggplot(data = gas, aes(x = gallons, y = sales, color = weekend)) +
        geom_point() +
        labs(x = "Gallons", y = "sales") +
        guides(color = guide_legend(title = "Day Type")) +
        geom_hline(yintercept = mean(gas$sales)) +
        geom_vline(xintercept = mean(gas$gallons))
```

### Part B, Estimate the Linear Equation, using the least-Square method

```{r, echo = FALSE}
gasLM <- lm(sales ~ gallons, data = gas)
```

From this the equation is:
$sales = `r gasLM$coefficients[1]` + `r gasLM$coefficients[2]` * gallons$

### Part C, Interpret the summary values r^2^ 

```{r, include = FALSE}
modelSummary <- gasLM %>% summary

```

**The r-squared value is:** `r modelSummary$r.squared`

`r modelSummary$r.squared*100 ` percent of the variation in sales can be explained by the change in gallons sold on a given day.

**The standard error:** `r modelSummary$coefficients[2,2]`

`r modelSummary$coefficients[2,2] ` is the average measurement error from the regression line. 

### Part D, different preditions

```{r, echo = FALSE}

inputPanel(
  numericInput("one", "First Value to be predicted", value = 3500),
  numericInput("two", "Second value to be predicted", value = 4000)
)

renderText({
  gasGallons <- data.frame(gallons = c(input$one, input$two))
  
  predictions <- predict.lm(gasLM, newdata = gasGallons)
  
  paste("The Difference between the two is: ",
       predictions[2] - predictions[1],
       ".", sep = "")
})

```

### Changing units, Part E

```{r, include = FALSE}

gas$liters <- gas$gallons * 3.7854
gas$cDollars <- gas$sales * 1.1

litersLm <- lm(cDollars ~ liters, data = gas)

litersLm %>% summary

```


**The new equations is:** $Sales = `r litersLm$coefficients[1]` + `r litersLm$coefficients[2]` * Liters$.

### Part F

A key component of this problem is the word 'causation'. "Correlation isn't causation" is an oft quoted statisticians maxim.` Causation is a word that we avoid using in regression/statistics in general. The best way to phrase our discovery is to put things interms of our response and explanitory variables.

We'd state that our response variable can be explained by our explanitory variable. So the amount sold can be explained by the number of gallons sold. How much explaining our explainitory variables is the R^2^ value. 

### Part G

```{r, include = FALSE}
newData <- data.frame(gallons = 4165)

pred4165 <- predict(gasLM, newdata = newData)

diffDat <- 1774 - pred4165
```

Our sales for the day were `r diffDat` than we expected.

### Part H, residuals plot,

```{r, echo = FALSE}
gas$residuals <- resid(gasLM)

ggplot(data = gas, aes(x = gallons, y = residuals, color = weekend)) +
  geom_point()

```

**The residual mean:** `r mean(resid(gasLM))`

**The residual sd:** `r sd(resid(gasLM))` 







